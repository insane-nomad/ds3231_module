# DS3231_MODULE

Программа для работы с модулями на основе микросхемы часов реального времени DS3231.

Возможности програмы:

- получение времени с NTP-сервера и запись времени на DS3231.
- вычисление точности хода часов на основе микросхемы DS3231.

## Принцип работы программы

При запуске программы с параметром  ```-command set -mod 1```, где 1 - номер модуля (например: если модулей много и хочется проверить на точность все модули) происходит:
- подключение к NTP-серверу, откуда берется точное время и записывается в регистры микросхемы DS3231.
- В каталоге ```modules``` создается текстовый файл с названием ```mod<номер модуля>.txt```, куда записывается дата и время синхронизации для возможности последующего вычисления точности хода часов в ppm.

При запуске программы с параметром  ```-command compare -mod 1```, где 1 - номер модуля (например: если модулей много и хочется проверить на точность все модули) происходит:
- подключение к NTP-серверу, откуда берется точное время
- вычитывается время с микросхемы DS3231
- рассчитывается разница во времени между NTP-сервером и временем на микросхеме DS3231 (в секундах).
- рассчитывается разница во времени между NTP-сервером и временем синхронизации модуля (в секундах). При этом важно правильно указать номер модуля.
- при завершении сравнения выводится таблица с (примерно такими) данными, где:
  -- Time from NTP - дата и время с NTP-сервера
  -- Time from file - дата и время синхронизации модуля с NTP-сервером
  -- Time from module - дата и время с DS3231
  -- Sec from file time - время, прошедшее с момента синхронизации
  -- Accuracy - точностьт хода DS3231 в ppm
   
```	
	+-----------------------------------------------------+
	|                  Time is compared                   |
	+-----------------------------------------------------+
	| Time from NTP         2023-10-09 21:07:13 +0000 UTC |
	| Time from file        2023-10-09 10:00:29 +0000 UTC |
	| Time from module      2023-10-09 21:07:13 +0000 UTC |
	| Sec from file time    40004                     sec |
	| Accuracy              0                         ppm |
	+-----------------------------------------------------+
	
```

## Добавлено
Сохранение результата ppm в каталоге с аналогичным названием, сохранение полных результатов тестирования модулей в каталоге fullresult. Это сделано для более удобного последующего анализа данных

## Рекомендации

Чем больше времени пройдет с момента синхронизации до момента проверки часов (значение Sec from file time) - тем выше точность расчета точности хода часов.
Рекомендуемое значение Sec from file time не менее 1 000 000 секунд (то есть не менее 12 дней с момента синхронизации времени), лучше - больше

## Дополнительно

Для непосредственой работы с часами используется плата Arduino Uno. Подойдет любая плата ардуино. Скетч для ардуино и библиотека для работы с модулем находятся в каталоге ```For arduino```. 
Работа с arduino стандартнаяЖ подключить к arduino модуль часов, подключить arduino к ПК,  скомпилировать и залить скетч на плату arduino.